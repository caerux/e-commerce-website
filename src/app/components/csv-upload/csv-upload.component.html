<div class="container mt-5 pt-5">
  <h2 class="text-center mb-4">CSV Upload</h2>

  <!-- File Upload Section -->
  <div class="mb-4 d-flex flex-column align-items-center">
    <input
      type="file"
      accept=".csv"
      (change)="onFileSelected($event)"
      class="form-control w-50"
    />
    <button class="btn btn-success mt-3 w-50" (click)="uploadCsv()">
      Upload CSV
    </button>

    <!-- Error Message Display -->
    <div *ngIf="errorMessage" class="alert alert-danger mt-3 w-50 text-center">
      {{ errorMessage }}
    </div>
  </div>

  <!-- Order Details Display -->
  <div *ngIf="orderDetails.length > 0">
    <h3 class="text-center">Order Details</h3>
    <table class="table table-bordered table-striped text-center">
      <thead class="table-dark">
        <tr>
          <th>Product Barcode</th>
          <th>Product Name</th>
          <th>Quantity</th>
          <th>Unit Price (₹)</th>
          <th>Subtotal (₹)</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of orderDetails">
          <td>{{ item.barcode }}</td>
          <td>{{ item.name }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.price | number : "1.2-2" }}</td>
          <td>{{ item.subtotal | number : "1.2-2" }}</td>
        </tr>
        <tr>
          <td colspan="4"><strong>Total</strong></td>
          <td>
            <strong>{{ totalAmount | number : "1.2-2" }}</strong>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Proceed to Checkout Button -->
    <div class="text-center">
      <button class="btn btn-primary mt-3" (click)="proceedToCheckout()">
        Proceed to Checkout
      </button>
    </div>
  </div>

  <!-- No Order Details Message -->
  <div
    *ngIf="orderDetails.length === 0 && csvFile && csvProcessed"
    class="text-center text-danger"
  >
    <p>No valid products found in the uploaded CSV.</p>
  </div>
</div>
